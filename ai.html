<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>VisionaryStudio — Chat</title>

<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@700;800&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>

/* ---------------------------------------------
   ROOT VARIABLES
--------------------------------------------- */
:root{
  --g-indigo:#6366F1;
  --g-violet:#8B5CF6;
  --g-pink:#EC4899;

  --bubble-top:rgba(6,6,8,0.95);
  --bubble-bottom:rgba(8,8,10,0.72);
}

/* ---------------------------------------------
   GLOBAL
--------------------------------------------- */
*{margin:0;padding:0;box-sizing:border-box}
html,body{
  height:100%;
  overflow:hidden;
  font-family:Inter,sans-serif;
  color:white;
}

/* ---------------------------------------------
   FIXED BACKGROUND
--------------------------------------------- */
.vs-fixed-bg{
  position:fixed;
  inset:0;
  z-index:-10;
  background-image:url("https://images.unsplash.com/photo-1604879616509-d841eec0ca4e?q=80&w=1740&auto=format&fit=crop");
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  pointer-events:none;
  filter:brightness(.92);
}
@media (max-width:900px){
  .vs-fixed-bg{
    background-image:url("https://images.unsplash.com/photo-1628498188873-579210ce622e?q=80&w=654&auto=format&fit=crop");
    background-position:center top;
  }
}

/* ---------------------------------------------
   NAVBAR
--------------------------------------------- */
.nav-wrap{
  position:fixed;
  top:18px; left:0; right:0;
  display:flex; justify-content:center;
  z-index:300;
}

.nav{
  width:98%; max-width:1350px;
  height:72px; padding:10px 24px;
  display:flex; justify-content:space-between;
  align-items:center;
  border-radius:20px;
  background:rgba(0,0,0,0.65);
  border:1px solid rgba(255,255,255,0.7);
  backdrop-filter:blur(16px);
  box-shadow:
    0 0 18px rgba(255,255,255,0.25),
    0 18px 60px rgba(0,0,0,0.8);
}

.brand-wrap{display:flex;align-items:center;gap:12px}
.brand-logo{
  width:44px;height:44px;border-radius:50%;
  background:rgba(0,0,0,0.6);
  border:1px solid rgba(255,255,255,0.6);
}

.brand{
  font-family:'Space Grotesk';
  font-weight:800; font-size:1.35rem;
  background:linear-gradient(135deg,var(--g-indigo),var(--g-violet),var(--g-pink));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

/* NAV LINKS */
nav.primary{
  display:flex; gap:34px; align-items:center;
}
nav.primary a{
  font-family:'Space Grotesk';
  font-weight:800;
  text-decoration:none;
  color:white;
  font-size:0.9rem;
  letter-spacing:0.16em;
  position:relative;
  transition:.25s;
}
nav.primary a:hover{transform:translateY(-2px);opacity:0.9}
nav.primary a::after{
  content:"";
  position:absolute;
  bottom:-6px; left:0;
  width:0%; height:2px;
  background:linear-gradient(90deg,var(--g-indigo),var(--g-violet),var(--g-pink));
  transition:.3s;
  border-radius:4px;
}
nav.primary a:hover::after{width:100%}

/* ---------------------------------------------
   TRI-DOT MENU
--------------------------------------------- */
.tri-menu{
  display:none;
  position:relative;
  width:46px;height:46px;border-radius:14px;
  background:rgba(0,0,0,0.55);
  border:1px solid rgba(255,255,255,0.5);
  backdrop-filter:blur(12px);
  cursor:pointer;
  box-shadow:0 0 18px rgba(129,140,248,0.7);
  justify-content:center;align-items:center;
  transition:.3s;
  -webkit-tap-highlight-color:transparent;
}

.tri-dot{
  position:absolute;
  width:8px;height:8px;
  background:white;border-radius:50%;
  box-shadow:0 0 8px rgba(255,255,255,0.9);
  transition:opacity .22s ease, filter .22s ease;
}

.tri-dot.dot1{top:50%;left:50%;transform:translate(-50%,-50%)}
.tri-dot.dot2{top:11px;left:11px}
.tri-dot.dot3{bottom:11px;right:11px}

.tri-menu.rolling{
  animation:diceRoll 0.45s ease-in-out;
}

@keyframes diceRoll{
  0%{transform:translateY(0) rotate(0deg);}
  20%{transform:translateY(-2px) rotate(10deg);}
  40%{transform:translateY(2px) rotate(-10deg);}
  60%{transform:translateY(-1px) rotate(6deg);}
  80%{transform:translateY(1px) rotate(-4deg);}
  100%{transform:translateY(0) rotate(0deg);}
}

/* MOBILE DROPDOWN */
.mobile-dropdown{
  position:fixed;
  top:100px; left:50%;
  transform:translateX(-50%) translateY(-10px);
  width:88%; max-width:720px;
  background:rgba(0,0,0,0.9);
  backdrop-filter:blur(10px);
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.35);
  padding:12px 0;
  display:flex;flex-direction:column;
  align-items:center; gap:8px;
  opacity:0; pointer-events:none;
  transition:opacity .22s ease, transform .22s ease;
  z-index:200;
}
.mobile-dropdown.active{
  opacity:1;
  pointer-events:auto;
  transform:translateX(-50%) translateY(0);
}
.mobile-dropdown a{
  font-family:'Space Grotesk';
  font-weight:800;
  color:white;
  letter-spacing:0.16em;
  font-size:0.85rem;
  text-decoration:none;
  padding:8px 4px;
}

@media(max-width:900px){
  nav.primary{display:none}
  .tri-menu{display:flex}
}

/* ---------------------------------------------
   CHAT AREA
--------------------------------------------- */
.chat-page{
  position:fixed;top:100px;left:0;right:0;bottom:0;
  overflow-y:auto; padding:20px;
  display:flex; justify-content:center;
}

.msg-column{width:100%;max-width:880px}

.top-desc{
  margin-top:12px;text-align:center;
  font-size:1.05rem;font-weight:600;
  background:linear-gradient(90deg,var(--g-indigo),var(--g-violet),var(--g-pink));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  opacity:1;transition:.25s;
}
.top-desc.hidden{
  opacity:0;transform:translateY(-10px);pointer-events:none;
}

.chat-stage{
  margin-top:20px;padding-bottom:180px;
  display:flex;flex-direction:column;gap:14px;
}

.msg-row{width:100%;display:flex}
.msg-row.user{justify-content:flex-end}
.msg-row.bot{justify-content:flex-start}

.msg-bubble{
  max-width:76%;
  padding:14px 16px;
  border-radius:18px;
  background:linear-gradient(180deg,var(--bubble-top),var(--bubble-bottom));
  border:1px solid rgba(255,255,255,0.06);
  backdrop-filter:blur(10px);
  opacity:0;transform:translateY(8px);
  transition:.25s;
}
.msg-bubble.show{
  opacity:1;transform:translateY(0);
}
.msg-text{
  color:white;
  font-size:0.96rem;
}

/* ---------------------------------------------
   TYPING INDICATOR
--------------------------------------------- */
.typing-bubble {
  max-width: 70%;
  padding: 14px 16px;
  border-radius: 18px;
  background: linear-gradient(180deg, var(--bubble-top), var(--bubble-bottom));
  border: 1px solid rgba(255,255,255,0.06);
  backdrop-filter: blur(10px);
  display: inline-flex;
  gap: 6px;
  opacity: 0;
  transform: translateY(8px);
  transition: .25s;
}

.typing-bubble.show {
  opacity: 1;
  transform: translateY(0);
}

.dot {
  width: 6px; height: 6px;
  background: white;
  border-radius: 50%;
  animation: blink 1.4s infinite ease-in-out;
}

.dot:nth-child(2) { animation-delay: 0.2s; }
.dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes blink {
  0%, 80%, 100% { opacity: 0.2; }
  40% { opacity: 1; }
}

/* ---------------------------------------------
   INPUT BAR
--------------------------------------------- */
.floating-input{
  position:fixed;
  bottom:20px; left:50%;
  transform:translateX(-50%);
  width:100%; max-width:760px;
  padding:0 12px; z-index:400;
}

.input-inner{
  display:flex; align-items:center; gap:10px;
  padding:6px 14px;
  border-radius:28px;
  background:rgba(0,0,0,0.28);
  border:1px solid rgba(255,255,255,0.12);
  backdrop-filter:blur(12px);
}

.input-textarea{
  flex:1; background:transparent;
  border:none !important; outline:none !important;
  color:white; font-size:0.92rem;
  padding:4px 0;
  resize:none; overflow-y:hidden;
  min-height:20px; max-height:120px;
}

.btn-send{
  width:40px;height:40px;border-radius:50%;
  background:linear-gradient(135deg,#7C5CFF,#06B6D4);
  display:flex;align-items:center;justify-content:center;
  border:none;cursor:pointer;
}
.btn-send svg{fill:white;width:18px;height:18px}

</style>
</head>

<body>

<div class="vs-fixed-bg"></div>

<!-- NAV -->
<div class="nav-wrap">
<header class="nav">

  <div class="brand-wrap">
    <img src="vs.png" class="brand-logo">
    <div class="brand">VisionaryStudio</div>
  </div>

  <nav class="primary">
    <a href="index.html">HOME</a>
    <a href="core.html">CORE</a>
    <a href="connect.html">CONNECT</a>
    <a href="see.html">DEMO</a>
  </nav>

  <button class="tri-menu" id="triMenuButton">
    <div class="tri-dot dot1"></div>
    <div class="tri-dot dot2"></div>
    <div class="tri-dot dot3"></div>
  </button>

</header>
</div>

<!-- MOBILE DROPDOWN -->
<div class="mobile-dropdown" id="mobileDropdown">
  <a href="index.html">HOME</a>
  <a href="core.html">CORE</a>
  <a href="connect.html">CONNECT</a>
  <a href="see.html">DEMO</a>
</div>

<!-- CHAT -->
<div class="chat-page" id="chatPage">
  <div class="msg-column">

    <div class="top-desc" id="topDesc">
      Describe an idea or say "Help me create an idea".
    </div>

    <div class="chat-stage" id="chatStage"></div>

  </div>
</div>

<!-- INPUT -->
<div class="floating-input">
  <div class="input-inner">
    <textarea id="chatInput" class="input-textarea" placeholder="Describe your idea…"></textarea>
    <button class="btn-send" id="btnSend">
      <svg viewBox="0 0 24 24"><path d="M2 21L23 12 2 3v7l15 2-15 2z"/></svg>
    </button>
  </div>
</div>

<script>

/* ---------------------------------------------
   GEMINI API
--------------------------------------------- */
const GEMINI_API_KEY = "AIzaSyBi1b-shwrEkSwIly2373LuuNJEnqdCBq8";

async function geminiGenerate(message) {
  const url =
    "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent";

  const body = {
    contents: [
      {
        role: "user",
        parts: [{ text: message }]
      }
    ]
  };

  try {
    const res = await fetch(url, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-goog-api-key": GEMINI_API_KEY
      },
      body: JSON.stringify(body)
    });

    const data = await res.json();

    if (data.error) {
      return "Gemini Error: " + data.error.message;
    }

    return (
      data?.candidates?.[0]?.content?.parts?.[0]?.text ||
      "No response received."
    );

  } catch (err) {
    return "Network error — failed to reach Gemini.";
  }
}

/* ---------------------------------------------
   TRI-DOT MENU JS
--------------------------------------------- */
const triMenu = document.getElementById("triMenuButton");
const mobileDropdown = document.getElementById("mobileDropdown");
const dotsMenu = triMenu.querySelectorAll(".tri-dot");

let diceState = 1;

function renderDiceFace(n) {
  dotsMenu.forEach(dot => (dot.style.opacity = 0));
  if (n === 1) dotsMenu[0].style.opacity = 1;
  if (n === 2) { dotsMenu[1].style.opacity = 1; dotsMenu[2].style.opacity = 1; }
  if (n === 3) dotsMenu.forEach(dot => (dot.style.opacity = 1));
}
renderDiceFace(diceState);

triMenu.addEventListener("click", e => {
  e.stopPropagation();

  if (!triMenu.classList.contains("rolling")) {
    triMenu.classList.add("rolling");

    dotsMenu.forEach(dot => {
      dot.style.filter = "blur(2px)";
    });

    setTimeout(() => {
      diceState = diceState === 3 ? 1 : diceState + 1;
      renderDiceFace(diceState);
      dotsMenu.forEach(dot => (dot.style.filter = "blur(0)"));
    }, 180);

    setTimeout(() => triMenu.classList.remove("rolling"), 450);
  }

  triMenu.classList.toggle("open");
  mobileDropdown.classList.toggle("active");
});

document.addEventListener("click", e => {
  if (!triMenu.contains(e.target) && !mobileDropdown.contains(e.target)) {
    mobileDropdown.classList.remove("active");
    triMenu.classList.remove("open");
  }
});

/* ---------------------------------------------
   CHAT LOGIC
--------------------------------------------- */
const stage = document.getElementById("chatStage");
const input = document.getElementById("chatInput");
const send = document.getElementById("btnSend");
const desc = document.getElementById("topDesc");
const chatPage = document.getElementById("chatPage");

function escapeHTML(t) {
  return t.replace(/</g, "&lt;").replace(/>/g, "&gt;");
}

function addMessage(text, who) {
  const row = document.createElement("div");
  row.className = "msg-row " + who;

  const bubble = document.createElement("div");
  bubble.className = "msg-bubble";

  const span = document.createElement("div");
  span.className = "msg-text";
  span.innerHTML = escapeHTML(text).replace(/\n/g, "<br>");

  bubble.appendChild(span);
  row.appendChild(bubble);
  stage.appendChild(row);

  setTimeout(() => bubble.classList.add("show"), 10);
  chatPage.scrollTop = chatPage.scrollHeight;
}

/* ---------------------------------------------
   TYPING INDICATOR
--------------------------------------------- */
let typingRow = null;

function showTypingIndicator() {
  typingRow = document.createElement("div");
  typingRow.className = "msg-row bot";

  const bubble = document.createElement("div");
  bubble.className = "typing-bubble";

  bubble.innerHTML = `
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
  `;

  typingRow.appendChild(bubble);
  stage.appendChild(typingRow);

  setTimeout(() => bubble.classList.add("show"), 10);
  chatPage.scrollTop = chatPage.scrollHeight;
}

function removeTypingIndicator() {
  if (typingRow) typingRow.remove();
  typingRow = null;
}

/* ---------------------------------------------
   BOT REPLY
--------------------------------------------- */
async function botReply(message) {
  return await geminiGenerate(message);
}

/* ---------------------------------------------
   INPUT & SEND
--------------------------------------------- */
let firstMessage = true;
function hideDesc() {
  if (firstMessage) {
    desc.classList.add("hidden");
    input.placeholder = "";
    firstMessage = false;
  }
}

async function sendMessage() {
  const txt = input.value.trim();
  if (!txt) return;

  hideDesc();
  addMessage(txt, "user");
  input.value = "";

  showTypingIndicator();

  const reply = await botReply(txt);

  removeTypingIndicator();

  addMessage(reply, "bot");
}

send.addEventListener("click", sendMessage);

input.addEventListener("keydown", e => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

input.addEventListener("input", () => {
  input.style.height = "20px";
  input.style.height = Math.min(120, input.scrollHeight) + "px";
});

</script>

</body>
</html>
